using gov.sandia.sld.common.data.wmi;
using Newtonsoft.Json;
using System.Collections.Generic;
using Xunit;

namespace UnitTest.wmi
{
    public class ProcessesShould
    {
        [Fact]
        public void ConstructAndConvertNumToStringOK()
        {
            Process p = new Process("test", 2, 3, 123_456_789, 33_445_566, 22_331_199, 234_567_890);

            Assert.Equal("test", p.Name);
            Assert.Equal((ulong)2, p.CPUNum);
            Assert.Equal((ulong)3, p.WorkingSetNum);
            Assert.Equal((ulong)123_456_789, p.WorkingSetPrivateNum);
            Assert.Equal((ulong)33_445_566, p.PoolNonpagedBytesNum);
            Assert.Equal((ulong)22_331_199, p.PoolPagedBytesNum);
            Assert.Equal((ulong)234_567_890, p.PrivateBytesNum);
            Assert.Equal("2", p.CPU);

            // Memory should return the largest value, which in this case is the private bytes number
            Assert.Equal(p.PrivateBytesNum, p.MemoryNum);
            Assert.Equal("234567890", p.Memory);
            Assert.Equal(223.7, p.MemoryInMBNum, 1);
            Assert.Equal("223.7", p.MemoryInMB);
        }

        [Fact]
        public void AddAdditionalValuesOK()
        {
            Process p = new Process("test", 2, 3, 4, 5, 6, 7);
            p.Add(7, 8, 9, 10, 11, 12);
            p.Add(22, 23, 24, 25, 26, 27);
            p.Add(66, 77, 88, 99, 111, 222);

            // CPU: 2 + 7 + 22 + 66 = 97
            // WorkingSetNum: 3 + 8 + 23 + 77 = 111
            // WorkingSetPrivateNum: 4 + 9 + 24 + 88 = 125
            // PoolNonpagedBytesNum: 5 + 10 + 25 + 99 = 139
            // PoolPagedBytesNum: 6 + 11 + 26 + 111 = 154
            // PrivateBytesNum: 7 + 12 + 27 + 222 = 268

            Assert.Equal((ulong)97, p.CPUNum);
            Assert.Equal((ulong)111, p.WorkingSetNum);
            Assert.Equal((ulong)125, p.WorkingSetPrivateNum);
            Assert.Equal((ulong)139, p.PoolNonpagedBytesNum);
            Assert.Equal((ulong)154, p.PoolPagedBytesNum);
            Assert.Equal((ulong)268, p.PrivateBytesNum);

            // Memory should return the largest value, which in this case is the private bytes number
            Assert.Equal(p.PrivateBytesNum, p.MemoryNum);
            Assert.Equal("268", p.Memory);

            Assert.Equal((ulong)4, p.NumProcesses);
        }

        [Fact]
        public void DeserializeOldStyleJSONOK()
        {
            string json =
"{\"Value\":{\"ApplicationFrameHost\":{\"CPU\":\"0\",\"Memory\":\"21536768\"},\"ccSvcHst\":{\"CPU\":\"0\",\"Memory\":\"25460736\"},\"chrome\":{\"CPU\":\"0\",\"Memory\":\"1303699456\"},\"COMMON\":{\"CPU\":\"0\",\"Memory\":\"88285184\"},\"csrss\":{\"CPU\":\"0\",\"Memory\":\"15331328\"},\"dwm\":{\"CPU\":\"0\",\"Memory\":\"141078528\"},\"explorer\":{\"CPU\":\"0\",\"Memory\":\"204525568\"},\"lsass\":{\"CPU\":\"0\",\"Memory\":\"51347456\"},\"mmc\":{\"CPU\":\"0\",\"Memory\":\"44941312\"},\"msdtc\":{\"CPU\":\"0\",\"Memory\":\"9932800\"},\"msiexec\":{\"CPU\":\"0\",\"Memory\":\"17756160\"},\"RuntimeBroker\":{\"CPU\":\"0\",\"Memory\":\"43139072\"},\"SearchUI\":{\"CPU\":\"0\",\"Memory\":\"125734912\"},\"services\":{\"CPU\":\"0\",\"Memory\":\"12406784\"},\"ShellExperienceHost\":{\"CPU\":\"0\",\"Memory\":\"105631744\"},\"sihost\":{\"CPU\":\"0\",\"Memory\":\"23818240\"},\"smss\":{\"CPU\":\"0\",\"Memory\":\"1282048\"},\"spoolsv\":{\"CPU\":\"0\",\"Memory\":\"17072128\"},\"svchost\":{\"CPU\":\"25\",\"Memory\":\"2899578880\"},\"System\":{\"CPU\":\"6\",\"Memory\":\"143360\"},\"taskhostw\":{\"CPU\":\"0\",\"Memory\":\"36024320\"},\"Taskmgr\":{\"CPU\":\"0\",\"Memory\":\"36880384\"},\"unsecapp\":{\"CPU\":\"0\",\"Memory\":\"10768384\"},\"wermgr\":{\"CPU\":\"0\",\"Memory\":\"13336576\"},\"wininit\":{\"CPU\":\"0\",\"Memory\":\"5021696\"},\"winlogon\":{\"CPU\":\"0\",\"Memory\":\"9641984\"},\"WmiApSrv\":{\"CPU\":\"0\",\"Memory\":\"8454144\"},\"WmiPrvSE\":{\"CPU\":\"1\",\"Memory\":\"278560768\"},\"WUDFHost\":{\"CPU\":\"0\",\"Memory\":\"9601024\"}}}";
            var definition = new { Value = new Dictionary<string, Process>() };
            var value = JsonConvert.DeserializeAnonymousType(json, definition);

            Assert.NotNull(value);
            Assert.NotNull(value.Value);
            Assert.NotEmpty(value.Value);
            bool exists = value.Value.TryGetValue("COMMON", out Process common);
            Assert.True(exists);

            // The name isn't part of the JSON data, it's just part of the map
            //Assert.Equal("COMMON", common.Name);
            Assert.Equal((ulong)0, common.CPUNum);
            Assert.Equal("0", common.CPU);

            // Because the old-style JSON didn't have the different fields, they should all be the same
            Assert.Equal((ulong)88285184, common.WorkingSetNum);
            Assert.Equal((ulong)88285184, common.WorkingSetPrivateNum);
            Assert.Equal((ulong)88285184, common.PoolNonpagedBytesNum);
            Assert.Equal((ulong)88285184, common.PoolPagedBytesNum);
            Assert.Equal((ulong)88285184, common.PrivateBytesNum);
            Assert.Equal("88285184", common.Memory);
            Assert.Equal((ulong)88285184, common.MemoryNum);
            Assert.Equal(84.2, common.MemoryInMBNum, 1);
        }

        [Fact]
        public void DeserializeNewStyleJSONOK()
        {
            string json =
"{\"Value\":{ \"Alert\":{ \"CPU\":\"0\",\"Memory\":\"4665344\",\"MemoryInMB\":\"4.4\",\"CPUNum\":0,\"WorkingSetNum\":3350528,\"WorkingSetPrivateNum\":2736128,\"PoolNonpagedBytesNum\":12624,\"PoolPagedBytesNum\":143360,\"PrivateBytesNum\":4665344,\"MemoryInMBNum\":4.44921875,\"WorkingSetInMBNum\":3.1953125,\"WorkingSetPrivateInMBNum\":2.609375,\"PoolNonpagedBytesInMBNum\":0.0120391846,\"PoolPagedBytesInMBNum\":0.13671875,\"PrivateBytesInMBNum\":4.44921875,\"NumProcesses\":1},\"armsvc\":{ \"CPU\":\"0\",\"Memory\":\"1589248\",\"MemoryInMB\":\"1.5\",\"CPUNum\":0,\"WorkingSetNum\":1396736,\"WorkingSetPrivateNum\":999424,\"PoolNonpagedBytesNum\":8416,\"PoolPagedBytesNum\":94096,\"PrivateBytesNum\":1589248,\"MemoryInMBNum\":1.515625,\"WorkingSetInMBNum\":1.33203125,\"WorkingSetPrivateInMBNum\":0.953125,\"PoolNonpagedBytesInMBNum\":0.008026123,\"PoolPagedBytesInMBNum\":0.08973694,\"PrivateBytesInMBNum\":1.515625,\"NumProcesses\":1},\"BCWipeSvc\":{ \"CPU\":\"0\",\"Memory\":\"3457024\",\"MemoryInMB\":\"3.3\",\"CPUNum\":0,\"WorkingSetNum\":3153920,\"WorkingSetPrivateNum\":2760704,\"PoolNonpagedBytesNum\":12752,\"PoolPagedBytesNum\":113424,\"PrivateBytesNum\":3457024,\"MemoryInMBNum\":3.296875,\"WorkingSetInMBNum\":3.0078125,\"WorkingSetPrivateInMBNum\":2.6328125,\"PoolNonpagedBytesInMBNum\":0.0121612549,\"PoolPagedBytesInMBNum\":0.108169556,\"PrivateBytesInMBNum\":3.296875,\"NumProcesses\":1},\"BCWipeTM\":{ \"CPU\":\"0\",\"Memory\":\"4407296\",\"MemoryInMB\":\"4.2\",\"CPUNum\":0,\"WorkingSetNum\":3080192,\"WorkingSetPrivateNum\":3055616,\"PoolNonpagedBytesNum\":21120,\"PoolPagedBytesNum\":220784,\"PrivateBytesNum\":4407296,\"MemoryInMBNum\":4.203125,\"WorkingSetInMBNum\":2.9375,\"WorkingSetPrivateInMBNum\":2.9140625,\"PoolNonpagedBytesInMBNum\":0.0201416016,\"PoolPagedBytesInMBNum\":0.21055603,\"PrivateBytesInMBNum\":4.203125,\"NumProcesses\":2},\"calc\":{ \"CPU\":\"0\",\"Memory\":\"17793024\",\"MemoryInMB\":\"17.0\",\"CPUNum\":0,\"WorkingSetNum\":17793024,\"WorkingSetPrivateNum\":8699904,\"PoolNonpagedBytesNum\":30192,\"PoolPagedBytesNum\":203448,\"PrivateBytesNum\":10838016,\"MemoryInMBNum\":16.96875,\"WorkingSetInMBNum\":16.96875,\"WorkingSetPrivateInMBNum\":8.296875,\"PoolNonpagedBytesInMBNum\":0.028793335,\"PoolPagedBytesInMBNum\":0.194023132,\"PrivateBytesInMBNum\":10.3359375,\"NumProcesses\":1},\"CcmExec\":{ \"CPU\":\"0\",\"Memory\":\"57520128\",\"MemoryInMB\":\"54.9\",\"CPUNum\":0,\"WorkingSetNum\":57520128,\"WorkingSetPrivateNum\":34390016,\"PoolNonpagedBytesNum\":47008,\"PoolPagedBytesNum\":378528,\"PrivateBytesNum\":45277184,\"MemoryInMBNum\":54.85547,\"WorkingSetInMBNum\":54.85547,\"WorkingSetPrivateInMBNum\":32.796875,\"PoolNonpagedBytesInMBNum\":0.0448303223,\"PoolPagedBytesInMBNum\":0.360992432,\"PrivateBytesInMBNum\":43.1796875,\"NumProcesses\":1},\"ccSvcHst\":{ \"CPU\":\"0\",\"Memory\":\"94113792\",\"MemoryInMB\":\"89.8\",\"CPUNum\":0,\"WorkingSetNum\":25735168,\"WorkingSetPrivateNum\":15839232,\"PoolNonpagedBytesNum\":139376,\"PoolPagedBytesNum\":578008,\"PrivateBytesNum\":94113792,\"MemoryInMBNum\":89.75391,\"WorkingSetInMBNum\":24.5429688,\"WorkingSetPrivateInMBNum\":15.1054688,\"PoolNonpagedBytesInMBNum\":0.132919312,\"PoolPagedBytesInMBNum\":0.5512314,\"PrivateBytesInMBNum\":89.75391,\"NumProcesses\":2},\"chrome\":{ \"CPU\":\"0\",\"Memory\":\"1242644480\",\"MemoryInMB\":\"1185.1\",\"CPUNum\":0,\"WorkingSetNum\":1242644480,\"WorkingSetPrivateNum\":840175616,\"PoolNonpagedBytesNum\":631488,\"PoolPagedBytesNum\":7516712,\"PrivateBytesNum\":1034682368,\"MemoryInMBNum\":1185.07813,\"WorkingSetInMBNum\":1185.07813,\"WorkingSetPrivateInMBNum\":801.2539,\"PoolNonpagedBytesInMBNum\":0.6022339,\"PoolPagedBytesInMBNum\":7.168495,\"PrivateBytesInMBNum\":986.75,\"NumProcesses\":18},\"cmd\":{ \"CPU\":\"0\",\"Memory\":\"4616192\",\"MemoryInMB\":\"4.4\",\"CPUNum\":0,\"WorkingSetNum\":3346432,\"WorkingSetPrivateNum\":1499136,\"PoolNonpagedBytesNum\":10528,\"PoolPagedBytesNum\":78112,\"PrivateBytesNum\":4616192,\"MemoryInMBNum\":4.40234375,\"WorkingSetInMBNum\":3.19140625,\"WorkingSetPrivateInMBNum\":1.4296875,\"PoolNonpagedBytesInMBNum\":0.0100402832,\"PoolPagedBytesInMBNum\":0.07449341,\"PrivateBytesInMBNum\":4.40234375,\"NumProcesses\":2},\"CmRcService\":{ \"CPU\":\"0\",\"Memory\":\"3960832\",\"MemoryInMB\":\"3.8\",\"CPUNum\":0,\"WorkingSetNum\":2695168,\"WorkingSetPrivateNum\":1871872,\"PoolNonpagedBytesNum\":15712,\"PoolPagedBytesNum\":150784,\"PrivateBytesNum\":3960832,\"MemoryInMBNum\":3.77734375,\"WorkingSetInMBNum\":2.5703125,\"WorkingSetPrivateInMBNum\":1.78515625,\"PoolNonpagedBytesInMBNum\":0.0149841309,\"PoolPagedBytesInMBNum\":0.143798828,\"PrivateBytesInMBNum\":3.77734375,\"NumProcesses\":1},\"Code\":{ \"CPU\":\"0\",\"Memory\":\"489836544\",\"MemoryInMB\":\"467.1\",\"CPUNum\":0,\"WorkingSetNum\":485502976,\"WorkingSetPrivateNum\":413777920,\"PoolNonpagedBytesNum\":238112,\"PoolPagedBytesNum\":3253968,\"PrivateBytesNum\":489836544,\"MemoryInMBNum\":467.144531,\"WorkingSetInMBNum\":463.011719,\"WorkingSetPrivateInMBNum\":394.609375,\"PoolNonpagedBytesInMBNum\":0.2270813,\"PoolPagedBytesInMBNum\":3.10322571,\"PrivateBytesInMBNum\":467.144531,\"NumProcesses\":6},\"COMMONCLI\":{ \"CPU\":\"0\",\"Memory\":\"17719296\",\"MemoryInMB\":\"16.9\",\"CPUNum\":0,\"WorkingSetNum\":17719296,\"WorkingSetPrivateNum\":4505600,\"PoolNonpagedBytesNum\":15864,\"PoolPagedBytesNum\":251944,\"PrivateBytesNum\":14340096,\"MemoryInMBNum\":16.8984375,\"WorkingSetInMBNum\":16.8984375,\"WorkingSetPrivateInMBNum\":4.296875,\"PoolNonpagedBytesInMBNum\":0.0151290894,\"PoolPagedBytesInMBNum\":0.240272522,\"PrivateBytesInMBNum\":13.6757813,\"NumProcesses\":1},\"conhost\":{ \"CPU\":\"0\",\"Memory\":\"53510144\",\"MemoryInMB\":\"51.0\",\"CPUNum\":0,\"WorkingSetNum\":53510144,\"WorkingSetPrivateNum\":13578240,\"PoolNonpagedBytesNum\":111488,\"PoolPagedBytesNum\":1612840,\"PrivateBytesNum\":23232512,\"MemoryInMBNum\":51.03125,\"WorkingSetInMBNum\":51.03125,\"WorkingSetPrivateInMBNum\":12.9492188,\"PoolNonpagedBytesInMBNum\":0.106323242,\"PoolPagedBytesInMBNum\":1.53812408,\"PrivateBytesInMBNum\":22.15625,\"NumProcesses\":16},\"csrss\":{ \"CPU\":\"0\",\"Memory\":\"8056832\",\"MemoryInMB\":\"7.7\",\"CPUNum\":0,\"WorkingSetNum\":8056832,\"WorkingSetPrivateNum\":3104768,\"PoolNonpagedBytesNum\":42496,\"PoolPagedBytesNum\":390920,\"PrivateBytesNum\":4923392,\"MemoryInMBNum\":7.68359375,\"WorkingSetInMBNum\":7.68359375,\"WorkingSetPrivateInMBNum\":2.9609375,\"PoolNonpagedBytesInMBNum\":0.0405273438,\"PoolPagedBytesInMBNum\":0.372810364,\"PrivateBytesInMBNum\":4.6953125,\"NumProcesses\":2},\"devenv\":{ \"CPU\":\"0\",\"Memory\":\"711438336\",\"MemoryInMB\":\"678.5\",\"CPUNum\":0,\"WorkingSetNum\":711438336,\"WorkingSetPrivateNum\":502210560,\"PoolNonpagedBytesNum\":324704,\"PoolPagedBytesNum\":2064744,\"PrivateBytesNum\":609071104,\"MemoryInMBNum\":678.480469,\"WorkingSetInMBNum\":678.480469,\"WorkingSetPrivateInMBNum\":478.9453,\"PoolNonpagedBytesInMBNum\":0.309661865,\"PoolPagedBytesInMBNum\":1.96909332,\"PrivateBytesInMBNum\":580.855469,\"NumProcesses\":1},\"dllhost\":{ \"CPU\":\"0\",\"Memory\":\"5906432\",\"MemoryInMB\":\"5.6\",\"CPUNum\":0,\"WorkingSetNum\":5906432,\"WorkingSetPrivateNum\":3018752,\"PoolNonpagedBytesNum\":13584,\"PoolPagedBytesNum\":81920,\"PrivateBytesNum\":3833856,\"MemoryInMBNum\":5.6328125,\"WorkingSetInMBNum\":5.6328125,\"WorkingSetPrivateInMBNum\":2.87890625,\"PoolNonpagedBytesInMBNum\":0.0129547119,\"PoolPagedBytesInMBNum\":0.078125,\"PrivateBytesInMBNum\":3.65625,\"NumProcesses\":1},\"dwm\":{ \"CPU\":\"0\",\"Memory\":\"713940992\",\"MemoryInMB\":\"680.9\",\"CPUNum\":0,\"WorkingSetNum\":696205312,\"WorkingSetPrivateNum\":447729664,\"PoolNonpagedBytesNum\":33040,\"PoolPagedBytesNum\":1256056,\"PrivateBytesNum\":713940992,\"MemoryInMBNum\":680.8672,\"WorkingSetInMBNum\":663.9531,\"WorkingSetPrivateInMBNum\":426.988281,\"PoolNonpagedBytesInMBNum\":0.0315094,\"PoolPagedBytesInMBNum\":1.19786835,\"PrivateBytesInMBNum\":680.8672,\"NumProcesses\":1},\"EMET_Agent\":{ \"CPU\":\"0\",\"Memory\":\"31256576\",\"MemoryInMB\":\"29.8\",\"CPUNum\":0,\"WorkingSetNum\":15331328,\"WorkingSetPrivateNum\":13438976,\"PoolNonpagedBytesNum\":27000,\"PoolPagedBytesNum\":450248,\"PrivateBytesNum\":31256576,\"MemoryInMBNum\":29.8085938,\"WorkingSetInMBNum\":14.6210938,\"WorkingSetPrivateInMBNum\":12.8164063,\"PoolNonpagedBytesInMBNum\":0.0257492065,\"PoolPagedBytesInMBNum\":0.429389954,\"PrivateBytesInMBNum\":29.8085938,\"NumProcesses\":1},\"EMET_Service\":{ \"CPU\":\"0\",\"Memory\":\"21250048\",\"MemoryInMB\":\"20.3\",\"CPUNum\":0,\"WorkingSetNum\":8359936,\"WorkingSetPrivateNum\":7573504,\"PoolNonpagedBytesNum\":17128,\"PoolPagedBytesNum\":262544,\"PrivateBytesNum\":21250048,\"MemoryInMBNum\":20.265625,\"WorkingSetInMBNum\":7.97265625,\"WorkingSetPrivateInMBNum\":7.22265625,\"PoolNonpagedBytesInMBNum\":0.0163345337,\"PoolPagedBytesInMBNum\":0.25038147,\"PrivateBytesInMBNum\":20.265625,\"NumProcesses\":1},\"explorer\":{ \"CPU\":\"0\",\"Memory\":\"346378240\",\"MemoryInMB\":\"330.3\",\"CPUNum\":0,\"WorkingSetNum\":346378240,\"WorkingSetPrivateNum\":76398592,\"PoolNonpagedBytesNum\":110064,\"PoolPagedBytesNum\":1907264,\"PrivateBytesNum\":97673216,\"MemoryInMBNum\":330.332031,\"WorkingSetInMBNum\":330.332031,\"WorkingSetPrivateInMBNum\":72.859375,\"PoolNonpagedBytesInMBNum\":0.10496521,\"PoolPagedBytesInMBNum\":1.81890869,\"PrivateBytesInMBNum\":93.14844,\"NumProcesses\":1},\"fdhost\":{ \"CPU\":\"0\",\"Memory\":\"14749696\",\"MemoryInMB\":\"14.1\",\"CPUNum\":0,\"WorkingSetNum\":1384448,\"WorkingSetPrivateNum\":1191936,\"PoolNonpagedBytesNum\":11376,\"PoolPagedBytesNum\":75440,\"PrivateBytesNum\":14749696,\"MemoryInMBNum\":14.0664063,\"WorkingSetInMBNum\":1.3203125,\"WorkingSetPrivateInMBNum\":1.13671875,\"PoolNonpagedBytesInMBNum\":0.010848999,\"PoolPagedBytesInMBNum\":0.07194519,\"PrivateBytesInMBNum\":14.0664063,\"NumProcesses\":1},\"fdlauncher\":{ \"CPU\":\"0\",\"Memory\":\"1384448\",\"MemoryInMB\":\"1.3\",\"CPUNum\":0,\"WorkingSetNum\":1253376,\"WorkingSetPrivateNum\":856064,\"PoolNonpagedBytesNum\":7008,\"PoolPagedBytesNum\":53976,\"PrivateBytesNum\":1384448,\"MemoryInMBNum\":1.3203125,\"WorkingSetInMBNum\":1.1953125,\"WorkingSetPrivateInMBNum\":0.81640625,\"PoolNonpagedBytesInMBNum\":0.00668334961,\"PoolPagedBytesInMBNum\":0.0514755249,\"PrivateBytesInMBNum\":1.3203125,\"NumProcesses\":1},\"gitlab-runner-windows-amd64\":{ \"CPU\":\"0\",\"Memory\":\"14356480\",\"MemoryInMB\":\"13.7\",\"CPUNum\":0,\"WorkingSetNum\":14356480,\"WorkingSetPrivateNum\":8990720,\"PoolNonpagedBytesNum\":18240,\"PoolPagedBytesNum\":236416,\"PrivateBytesNum\":12292096,\"MemoryInMBNum\":13.6914063,\"WorkingSetInMBNum\":13.6914063,\"WorkingSetPrivateInMBNum\":8.574219,\"PoolNonpagedBytesInMBNum\":0.01739502,\"PoolPagedBytesInMBNum\":0.225463867,\"PrivateBytesInMBNum\":11.7226563,\"NumProcesses\":1},\"iisexpress\":{ \"CPU\":\"0\",\"Memory\":\"18857984\",\"MemoryInMB\":\"18.0\",\"CPUNum\":0,\"WorkingSetNum\":18857984,\"WorkingSetPrivateNum\":5877760,\"PoolNonpagedBytesNum\":44960,\"PoolPagedBytesNum\":301576,\"PrivateBytesNum\":10588160,\"MemoryInMBNum\":17.984375,\"WorkingSetInMBNum\":17.984375,\"WorkingSetPrivateInMBNum\":5.60546875,\"PoolNonpagedBytesInMBNum\":0.0428771973,\"PoolPagedBytesInMBNum\":0.2876053,\"PrivateBytesInMBNum\":10.0976563,\"NumProcesses\":1},\"iisexpresstray\":{ \"CPU\":\"0\",\"Memory\":\"41365504\",\"MemoryInMB\":\"39.4\",\"CPUNum\":0,\"WorkingSetNum\":41365504,\"WorkingSetPrivateNum\":13799424,\"PoolNonpagedBytesNum\":34960,\"PoolPagedBytesNum\":460224,\"PrivateBytesNum\":30470144,\"MemoryInMBNum\":39.44922,\"WorkingSetInMBNum\":39.44922,\"WorkingSetPrivateInMBNum\":13.1601563,\"PoolNonpagedBytesInMBNum\":0.0333404541,\"PoolPagedBytesInMBNum\":0.4389038,\"PrivateBytesInMBNum\":29.0585938,\"NumProcesses\":1},\"inetinfo\":{ \"CPU\":\"0\",\"Memory\":\"14409728\",\"MemoryInMB\":\"13.7\",\"CPUNum\":0,\"WorkingSetNum\":14409728,\"WorkingSetPrivateNum\":11689984,\"PoolNonpagedBytesNum\":17136,\"PoolPagedBytesNum\":102424,\"PrivateBytesNum\":12976128,\"MemoryInMBNum\":13.7421875,\"WorkingSetInMBNum\":13.7421875,\"WorkingSetPrivateInMBNum\":11.1484375,\"PoolNonpagedBytesInMBNum\":0.0163421631,\"PoolPagedBytesInMBNum\":0.09767914,\"PrivateBytesInMBNum\":12.375,\"NumProcesses\":1},\"IpOverUsbSvc\":{ \"CPU\":\"0\",\"Memory\":\"8445952\",\"MemoryInMB\":\"8.1\",\"CPUNum\":0,\"WorkingSetNum\":3665920,\"WorkingSetPrivateNum\":2273280,\"PoolNonpagedBytesNum\":16584,\"PoolPagedBytesNum\":156096,\"PrivateBytesNum\":8445952,\"MemoryInMBNum\":8.0546875,\"WorkingSetInMBNum\":3.49609375,\"WorkingSetPrivateInMBNum\":2.16796875,\"PoolNonpagedBytesInMBNum\":0.0158157349,\"PoolPagedBytesInMBNum\":0.148864746,\"PrivateBytesInMBNum\":8.0546875,\"NumProcesses\":1},\"java\":{ \"CPU\":\"0\",\"Memory\":\"195608576\",\"MemoryInMB\":\"186.5\",\"CPUNum\":0,\"WorkingSetNum\":149135360,\"WorkingSetPrivateNum\":145432576,\"PoolNonpagedBytesNum\":40720,\"PoolPagedBytesNum\":286792,\"PrivateBytesNum\":195608576,\"MemoryInMBNum\":186.546875,\"WorkingSetInMBNum\":142.226563,\"WorkingSetPrivateInMBNum\":138.695313,\"PoolNonpagedBytesInMBNum\":0.03883362,\"PoolPagedBytesInMBNum\":0.273506165,\"PrivateBytesInMBNum\":186.546875,\"NumProcesses\":1},\"jucheck\":{ \"CPU\":\"0\",\"Memory\":\"4136960\",\"MemoryInMB\":\"3.9\",\"CPUNum\":0,\"WorkingSetNum\":3080192,\"WorkingSetPrivateNum\":2740224,\"PoolNonpagedBytesNum\":17024,\"PoolPagedBytesNum\":218416,\"PrivateBytesNum\":4136960,\"MemoryInMBNum\":3.9453125,\"WorkingSetInMBNum\":2.9375,\"WorkingSetPrivateInMBNum\":2.61328125,\"PoolNonpagedBytesInMBNum\":0.0162353516,\"PoolPagedBytesInMBNum\":0.208297729,\"PrivateBytesInMBNum\":3.9453125,\"NumProcesses\":1},\"jusched\":{ \"CPU\":\"0\",\"Memory\":\"2293760\",\"MemoryInMB\":\"2.2\",\"CPUNum\":0,\"WorkingSetNum\":1576960,\"WorkingSetPrivateNum\":1564672,\"PoolNonpagedBytesNum\":13792,\"PoolPagedBytesNum\":188392,\"PrivateBytesNum\":2293760,\"MemoryInMBNum\":2.1875,\"WorkingSetInMBNum\":1.50390625,\"WorkingSetPrivateInMBNum\":1.4921875,\"PoolNonpagedBytesInMBNum\":0.0131530762,\"PoolPagedBytesInMBNum\":0.179664612,\"PrivateBytesInMBNum\":2.1875,\"NumProcesses\":1},\"lsass\":{ \"CPU\":\"0\",\"Memory\":\"13340672\",\"MemoryInMB\":\"12.7\",\"CPUNum\":0,\"WorkingSetNum\":13340672,\"WorkingSetPrivateNum\":7204864,\"PoolNonpagedBytesNum\":27792,\"PoolPagedBytesNum\":132216,\"PrivateBytesNum\":8126464,\"MemoryInMBNum\":12.7226563,\"WorkingSetInMBNum\":12.7226563,\"WorkingSetPrivateInMBNum\":6.87109375,\"PoolNonpagedBytesInMBNum\":0.0265045166,\"PoolPagedBytesInMBNum\":0.126091,\"PrivateBytesInMBNum\":7.75,\"NumProcesses\":1},\"LsiAgent\":{ \"CPU\":\"0\",\"Memory\":\"105275392\",\"MemoryInMB\":\"100.4\",\"CPUNum\":0,\"WorkingSetNum\":83537920,\"WorkingSetPrivateNum\":70275072,\"PoolNonpagedBytesNum\":55184,\"PoolPagedBytesNum\":322288,\"PrivateBytesNum\":105275392,\"MemoryInMBNum\":100.398438,\"WorkingSetInMBNum\":79.66797,\"WorkingSetPrivateInMBNum\":67.01953,\"PoolNonpagedBytesInMBNum\":0.0526275635,\"PoolPagedBytesInMBNum\":0.3073578,\"PrivateBytesInMBNum\":100.398438,\"NumProcesses\":1},\"LsiMods64\":{ \"CPU\":\"0\",\"Memory\":\"5148672\",\"MemoryInMB\":\"4.9\",\"CPUNum\":0,\"WorkingSetNum\":5148672,\"WorkingSetPrivateNum\":1064960,\"PoolNonpagedBytesNum\":9680,\"PoolPagedBytesNum\":67392,\"PrivateBytesNum\":1765376,\"MemoryInMBNum\":4.91015625,\"WorkingSetInMBNum\":4.91015625,\"WorkingSetPrivateInMBNum\":1.015625,\"PoolNonpagedBytesInMBNum\":0.009231567,\"PoolPagedBytesInMBNum\":0.06427002,\"PrivateBytesInMBNum\":1.68359375,\"NumProcesses\":1},\"LsiUser\":{ \"CPU\":\"0\",\"Memory\":\"18374656\",\"MemoryInMB\":\"17.5\",\"CPUNum\":0,\"WorkingSetNum\":18374656,\"WorkingSetPrivateNum\":7618560,\"PoolNonpagedBytesNum\":20912,\"PoolPagedBytesNum\":218160,\"PrivateBytesNum\":9043968,\"MemoryInMBNum\":17.5234375,\"WorkingSetInMBNum\":17.5234375,\"WorkingSetPrivateInMBNum\":7.265625,\"PoolNonpagedBytesInMBNum\":0.0199432373,\"PoolPagedBytesInMBNum\":0.208053589,\"PrivateBytesInMBNum\":8.625,\"NumProcesses\":1},\"ManagementAgentHost\":{ \"CPU\":\"0\",\"Memory\":\"6266880\",\"MemoryInMB\":\"6.0\",\"CPUNum\":0,\"WorkingSetNum\":6266880,\"WorkingSetPrivateNum\":3440640,\"PoolNonpagedBytesNum\":15968,\"PoolPagedBytesNum\":133832,\"PrivateBytesNum\":4718592,\"MemoryInMBNum\":5.9765625,\"WorkingSetInMBNum\":5.9765625,\"WorkingSetPrivateInMBNum\":3.28125,\"PoolNonpagedBytesInMBNum\":0.0152282715,\"PoolPagedBytesInMBNum\":0.127632141,\"PrivateBytesInMBNum\":4.5,\"NumProcesses\":1},\"MBAMAgent\":{ \"CPU\":\"0\",\"Memory\":\"6242304\",\"MemoryInMB\":\"6.0\",\"CPUNum\":0,\"WorkingSetNum\":6242304,\"WorkingSetPrivateNum\":3854336,\"PoolNonpagedBytesNum\":11984,\"PoolPagedBytesNum\":81120,\"PrivateBytesNum\":4399104,\"MemoryInMBNum\":5.953125,\"WorkingSetInMBNum\":5.953125,\"WorkingSetPrivateInMBNum\":3.67578125,\"PoolNonpagedBytesInMBNum\":0.011428833,\"PoolPagedBytesInMBNum\":0.07736206,\"PrivateBytesInMBNum\":4.1953125,\"NumProcesses\":1},\"Microsoft.Alm.Shared.Remoting.RemoteContainer.dll\":{ \"CPU\":\"0\",\"Memory\":\"46129152\",\"MemoryInMB\":\"44.0\",\"CPUNum\":0,\"WorkingSetNum\":31752192,\"WorkingSetPrivateNum\":23015424,\"PoolNonpagedBytesNum\":37048,\"PoolPagedBytesNum\":467776,\"PrivateBytesNum\":46129152,\"MemoryInMBNum\":43.9921875,\"WorkingSetInMBNum\":30.28125,\"WorkingSetPrivateInMBNum\":21.9492188,\"PoolNonpagedBytesInMBNum\":0.0353317261,\"PoolPagedBytesInMBNum\":0.446105957,\"PrivateBytesInMBNum\":43.9921875,\"NumProcesses\":1},\"MSBuild\":{ \"CPU\":\"0\",\"Memory\":\"175923200\",\"MemoryInMB\":\"167.8\",\"CPUNum\":0,\"WorkingSetNum\":175923200,\"WorkingSetPrivateNum\":69255168,\"PoolNonpagedBytesNum\":98032,\"PoolPagedBytesNum\":1276208,\"PrivateBytesNum\":121679872,\"MemoryInMBNum\":167.773438,\"WorkingSetInMBNum\":167.773438,\"WorkingSetPrivateInMBNum\":66.046875,\"PoolNonpagedBytesInMBNum\":0.0934906,\"PoolPagedBytesInMBNum\":1.21708679,\"PrivateBytesInMBNum\":116.042969,\"NumProcesses\":4},\"msdtc\":{ \"CPU\":\"0\",\"Memory\":\"3067904\",\"MemoryInMB\":\"2.9\",\"CPUNum\":0,\"WorkingSetNum\":2367488,\"WorkingSetPrivateNum\":1953792,\"PoolNonpagedBytesNum\":13680,\"PoolPagedBytesNum\":78312,\"PrivateBytesNum\":3067904,\"MemoryInMBNum\":2.92578125,\"WorkingSetInMBNum\":2.2578125,\"WorkingSetPrivateInMBNum\":1.86328125,\"PoolNonpagedBytesInMBNum\":0.0130462646,\"PoolPagedBytesInMBNum\":0.07468414,\"PrivateBytesInMBNum\":2.92578125,\"NumProcesses\":1},\"MsDtsSrvr\":{ \"CPU\":\"0\",\"Memory\":\"53170176\",\"MemoryInMB\":\"50.7\",\"CPUNum\":0,\"WorkingSetNum\":7909376,\"WorkingSetPrivateNum\":7057408,\"PoolNonpagedBytesNum\":23240,\"PoolPagedBytesNum\":263032,\"PrivateBytesNum\":53170176,\"MemoryInMBNum\":50.70703,\"WorkingSetInMBNum\":7.54296875,\"WorkingSetPrivateInMBNum\":6.73046875,\"PoolNonpagedBytesInMBNum\":0.0221633911,\"PoolPagedBytesInMBNum\":0.250846863,\"PrivateBytesInMBNum\":50.70703,\"NumProcesses\":1},\"Node\":{ \"CPU\":\"0\",\"Memory\":\"175357952\",\"MemoryInMB\":\"167.2\",\"CPUNum\":0,\"WorkingSetNum\":170639360,\"WorkingSetPrivateNum\":157745152,\"PoolNonpagedBytesNum\":64800,\"PoolPagedBytesNum\":509656,\"PrivateBytesNum\":175357952,\"MemoryInMBNum\":167.234375,\"WorkingSetInMBNum\":162.734375,\"WorkingSetPrivateInMBNum\":150.4375,\"PoolNonpagedBytesInMBNum\":0.0617980957,\"PoolPagedBytesInMBNum\":0.486045837,\"PrivateBytesInMBNum\":167.234375,\"NumProcesses\":3},\"NwmCli\":{ \"CPU\":\"0\",\"Memory\":\"2715648\",\"MemoryInMB\":\"2.6\",\"CPUNum\":0,\"WorkingSetNum\":2715648,\"WorkingSetPrivateNum\":1490944,\"PoolNonpagedBytesNum\":12512,\"PoolPagedBytesNum\":169896,\"PrivateBytesNum\":2330624,\"MemoryInMBNum\":2.58984375,\"WorkingSetInMBNum\":2.58984375,\"WorkingSetPrivateInMBNum\":1.421875,\"PoolNonpagedBytesInMBNum\":0.011932373,\"PoolPagedBytesInMBNum\":0.162025452,\"PrivateBytesInMBNum\":2.22265625,\"NumProcesses\":1},\"NwmSvc\":{ \"CPU\":\"0\",\"Memory\":\"8540160\",\"MemoryInMB\":\"8.1\",\"CPUNum\":0,\"WorkingSetNum\":8540160,\"WorkingSetPrivateNum\":2908160,\"PoolNonpagedBytesNum\":21456,\"PoolPagedBytesNum\":174224,\"PrivateBytesNum\":4255744,\"MemoryInMBNum\":8.144531,\"WorkingSetInMBNum\":8.144531,\"WorkingSetPrivateInMBNum\":2.7734375,\"PoolNonpagedBytesInMBNum\":0.0204620361,\"PoolPagedBytesInMBNum\":0.166152954,\"PrivateBytesInMBNum\":4.05859375,\"NumProcesses\":1},\"OfficeClickToRun\":{ \"CPU\":\"0\",\"Memory\":\"43499520\",\"MemoryInMB\":\"41.5\",\"CPUNum\":0,\"WorkingSetNum\":43499520,\"WorkingSetPrivateNum\":32100352,\"PoolNonpagedBytesNum\":28768,\"PoolPagedBytesNum\":270520,\"PrivateBytesNum\":41156608,\"MemoryInMBNum\":41.484375,\"WorkingSetInMBNum\":41.484375,\"WorkingSetPrivateInMBNum\":30.6132813,\"PoolNonpagedBytesInMBNum\":0.0274353027,\"PoolPagedBytesInMBNum\":0.257987976,\"PrivateBytesInMBNum\":39.25,\"NumProcesses\":1},\"oracle\":{ \"CPU\":\"0\",\"Memory\":\"3342786560\",\"MemoryInMB\":\"3187.9\",\"CPUNum\":0,\"WorkingSetNum\":48476160,\"WorkingSetPrivateNum\":29319168,\"PoolNonpagedBytesNum\":49200,\"PoolPagedBytesNum\":588760,\"PrivateBytesNum\":3342786560,\"MemoryInMBNum\":3187.92969,\"WorkingSetInMBNum\":46.23047,\"WorkingSetPrivateInMBNum\":27.9609375,\"PoolNonpagedBytesInMBNum\":0.0469207764,\"PoolPagedBytesInMBNum\":0.5614853,\"PrivateBytesInMBNum\":3187.92969,\"NumProcesses\":1},\"PerfWatson2\":{ \"CPU\":\"0\",\"Memory\":\"63463424\",\"MemoryInMB\":\"60.5\",\"CPUNum\":0,\"WorkingSetNum\":60280832,\"WorkingSetPrivateNum\":47050752,\"PoolNonpagedBytesNum\":77640,\"PoolPagedBytesNum\":425248,\"PrivateBytesNum\":63463424,\"MemoryInMBNum\":60.5234375,\"WorkingSetInMBNum\":57.48828,\"WorkingSetPrivateInMBNum\":44.8710938,\"PoolNonpagedBytesInMBNum\":0.0740432739,\"PoolPagedBytesInMBNum\":0.4055481,\"PrivateBytesInMBNum\":60.5234375,\"NumProcesses\":1},\"pg_ctl\":{ \"CPU\":\"0\",\"Memory\":\"2142208\",\"MemoryInMB\":\"2.0\",\"CPUNum\":0,\"WorkingSetNum\":1466368,\"WorkingSetPrivateNum\":1097728,\"PoolNonpagedBytesNum\":8800,\"PoolPagedBytesNum\":111904,\"PrivateBytesNum\":2142208,\"MemoryInMBNum\":2.04296875,\"WorkingSetInMBNum\":1.3984375,\"WorkingSetPrivateInMBNum\":1.046875,\"PoolNonpagedBytesInMBNum\":0.008392334,\"PoolPagedBytesInMBNum\":0.106719971,\"PrivateBytesInMBNum\":2.04296875,\"NumProcesses\":1},\"policyHost\":{ \"CPU\":\"0\",\"Memory\":\"21372928\",\"MemoryInMB\":\"20.4\",\"CPUNum\":0,\"WorkingSetNum\":21372928,\"WorkingSetPrivateNum\":7254016,\"PoolNonpagedBytesNum\":19072,\"PoolPagedBytesNum\":185248,\"PrivateBytesNum\":10809344,\"MemoryInMBNum\":20.3828125,\"WorkingSetInMBNum\":20.3828125,\"WorkingSetPrivateInMBNum\":6.91796875,\"PoolNonpagedBytesInMBNum\":0.0181884766,\"PoolPagedBytesInMBNum\":0.17666626,\"PrivateBytesInMBNum\":10.3085938,\"NumProcesses\":1},\"postgres\":{ \"CPU\":\"0\",\"Memory\":\"22077440\",\"MemoryInMB\":\"21.1\",\"CPUNum\":0,\"WorkingSetNum\":11886592,\"WorkingSetPrivateNum\":8859648,\"PoolNonpagedBytesNum\":59248,\"PoolPagedBytesNum\":2216712,\"PrivateBytesNum\":22077440,\"MemoryInMBNum\":21.0546875,\"WorkingSetInMBNum\":11.3359375,\"WorkingSetPrivateInMBNum\":8.449219,\"PoolNonpagedBytesInMBNum\":0.0565032959,\"PoolPagedBytesInMBNum\":2.1140213,\"PrivateBytesInMBNum\":21.0546875,\"NumProcesses\":7},\"RealTimeSync\":{ \"CPU\":\"0\",\"Memory\":\"1458176\",\"MemoryInMB\":\"1.4\",\"CPUNum\":0,\"WorkingSetNum\":909312,\"WorkingSetPrivateNum\":876544,\"PoolNonpagedBytesNum\":8048,\"PoolPagedBytesNum\":87568,\"PrivateBytesNum\":1458176,\"MemoryInMBNum\":1.390625,\"WorkingSetInMBNum\":0.8671875,\"WorkingSetPrivateInMBNum\":0.8359375,\"PoolNonpagedBytesInMBNum\":0.007675171,\"PoolPagedBytesInMBNum\":0.08351135,\"PrivateBytesInMBNum\":1.390625,\"NumProcesses\":1},\"RealTimeSync_x64\":{ \"CPU\":\"0\",\"Memory\":\"11902976\",\"MemoryInMB\":\"11.4\",\"CPUNum\":0,\"WorkingSetNum\":11902976,\"WorkingSetPrivateNum\":7684096,\"PoolNonpagedBytesNum\":44128,\"PoolPagedBytesNum\":271040,\"PrivateBytesNum\":10776576,\"MemoryInMBNum\":11.3515625,\"WorkingSetInMBNum\":11.3515625,\"WorkingSetPrivateInMBNum\":7.328125,\"PoolNonpagedBytesInMBNum\":0.04208374,\"PoolPagedBytesInMBNum\":0.2584839,\"PrivateBytesInMBNum\":10.2773438,\"NumProcesses\":1},\"SCNotification\":{ \"CPU\":\"0\",\"Memory\":\"28778496\",\"MemoryInMB\":\"27.4\",\"CPUNum\":0,\"WorkingSetNum\":18325504,\"WorkingSetPrivateNum\":12460032,\"PoolNonpagedBytesNum\":28040,\"PoolPagedBytesNum\":446984,\"PrivateBytesNum\":28778496,\"MemoryInMBNum\":27.4453125,\"WorkingSetInMBNum\":17.4765625,\"WorkingSetPrivateInMBNum\":11.8828125,\"PoolNonpagedBytesInMBNum\":0.0267410278,\"PoolPagedBytesInMBNum\":0.426277161,\"PrivateBytesInMBNum\":27.4453125,\"NumProcesses\":1},\"ScriptedSandbox64\":{ \"CPU\":\"0\",\"Memory\":\"51982336\",\"MemoryInMB\":\"49.6\",\"CPUNum\":0,\"WorkingSetNum\":51982336,\"WorkingSetPrivateNum\":26394624,\"PoolNonpagedBytesNum\":44696,\"PoolPagedBytesNum\":392224,\"PrivateBytesNum\":28962816,\"MemoryInMBNum\":49.57422,\"WorkingSetInMBNum\":49.57422,\"WorkingSetPrivateInMBNum\":25.171875,\"PoolNonpagedBytesInMBNum\":0.0426254272,\"PoolPagedBytesInMBNum\":0.374053955,\"PrivateBytesInMBNum\":27.6210938,\"NumProcesses\":1},\"SearchIndexer\":{ \"CPU\":\"0\",\"Memory\":\"36208640\",\"MemoryInMB\":\"34.5\",\"CPUNum\":0,\"WorkingSetNum\":35287040,\"WorkingSetPrivateNum\":26030080,\"PoolNonpagedBytesNum\":70384,\"PoolPagedBytesNum\":252984,\"PrivateBytesNum\":36208640,\"MemoryInMBNum\":34.53125,\"WorkingSetInMBNum\":33.6523438,\"WorkingSetPrivateInMBNum\":24.8242188,\"PoolNonpagedBytesInMBNum\":0.06712341,\"PoolPagedBytesInMBNum\":0.241264343,\"PrivateBytesInMBNum\":34.53125,\"NumProcesses\":1},\"ServiceHub.DataWarehouseHost\":{ \"CPU\":\"0\",\"Memory\":\"48934912\",\"MemoryInMB\":\"46.7\",\"CPUNum\":0,\"WorkingSetNum\":48934912,\"WorkingSetPrivateNum\":19128320,\"PoolNonpagedBytesNum\":28072,\"PoolPagedBytesNum\":388264,\"PrivateBytesNum\":37076992,\"MemoryInMBNum\":46.66797,\"WorkingSetInMBNum\":46.66797,\"WorkingSetPrivateInMBNum\":18.2421875,\"PoolNonpagedBytesInMBNum\":0.0267715454,\"PoolPagedBytesInMBNum\":0.3702774,\"PrivateBytesInMBNum\":35.359375,\"NumProcesses\":1},\"ServiceHub.Host.CLR.x86\":{ \"CPU\":\"0\",\"Memory\":\"46645248\",\"MemoryInMB\":\"44.5\",\"CPUNum\":0,\"WorkingSetNum\":35225600,\"WorkingSetPrivateNum\":23195648,\"PoolNonpagedBytesNum\":49080,\"PoolPagedBytesNum\":583168,\"PrivateBytesNum\":46645248,\"MemoryInMBNum\":44.484375,\"WorkingSetInMBNum\":33.59375,\"WorkingSetPrivateInMBNum\":22.1210938,\"PoolNonpagedBytesInMBNum\":0.0468063354,\"PoolPagedBytesInMBNum\":0.556152344,\"PrivateBytesInMBNum\":44.484375,\"NumProcesses\":1},\"ServiceHub.Host.Node.x86\":{ \"CPU\":\"0\",\"Memory\":\"31121408\",\"MemoryInMB\":\"29.7\",\"CPUNum\":0,\"WorkingSetNum\":31121408,\"WorkingSetPrivateNum\":25550848,\"PoolNonpagedBytesNum\":33152,\"PoolPagedBytesNum\":196760,\"PrivateBytesNum\":28512256,\"MemoryInMBNum\":29.6796875,\"WorkingSetInMBNum\":29.6796875,\"WorkingSetPrivateInMBNum\":24.3671875,\"PoolNonpagedBytesInMBNum\":0.03161621,\"PoolPagedBytesInMBNum\":0.187644958,\"PrivateBytesInMBNum\":27.1914063,\"NumProcesses\":1},\"ServiceHub.IdentityHost\":{ \"CPU\":\"0\",\"Memory\":\"27238400\",\"MemoryInMB\":\"26.0\",\"CPUNum\":0,\"WorkingSetNum\":23425024,\"WorkingSetPrivateNum\":16130048,\"PoolNonpagedBytesNum\":37816,\"PoolPagedBytesNum\":381752,\"PrivateBytesNum\":27238400,\"MemoryInMBNum\":25.9765625,\"WorkingSetInMBNum\":22.3398438,\"WorkingSetPrivateInMBNum\":15.3828125,\"PoolNonpagedBytesInMBNum\":0.0360641479,\"PoolPagedBytesInMBNum\":0.364067078,\"PrivateBytesInMBNum\":25.9765625,\"NumProcesses\":1},\"ServiceHub.RoslynCodeAnalysisService32\":{ \"CPU\":\"0\",\"Memory\":\"145903616\",\"MemoryInMB\":\"139.1\",\"CPUNum\":0,\"WorkingSetNum\":130744320,\"WorkingSetPrivateNum\":95334400,\"PoolNonpagedBytesNum\":92104,\"PoolPagedBytesNum\":893544,\"PrivateBytesNum\":145903616,\"MemoryInMBNum\":139.144531,\"WorkingSetInMBNum\":124.6875,\"WorkingSetPrivateInMBNum\":90.91797,\"PoolNonpagedBytesInMBNum\":0.08783722,\"PoolPagedBytesInMBNum\":0.852149963,\"PrivateBytesInMBNum\":139.144531,\"NumProcesses\":1},\"ServiceHub.SettingsHost\":{ \"CPU\":\"0\",\"Memory\":\"59518976\",\"MemoryInMB\":\"56.8\",\"CPUNum\":0,\"WorkingSetNum\":36380672,\"WorkingSetPrivateNum\":22564864,\"PoolNonpagedBytesNum\":49672,\"PoolPagedBytesNum\":575784,\"PrivateBytesNum\":59518976,\"MemoryInMBNum\":56.76172,\"WorkingSetInMBNum\":34.6953125,\"WorkingSetPrivateInMBNum\":21.5195313,\"PoolNonpagedBytesInMBNum\":0.04737091,\"PoolPagedBytesInMBNum\":0.5491104,\"PrivateBytesInMBNum\":56.76172,\"NumProcesses\":1},\"ServiceHub.VSDetouredHost\":{ \"CPU\":\"0\",\"Memory\":\"88186880\",\"MemoryInMB\":\"84.1\",\"CPUNum\":0,\"WorkingSetNum\":36585472,\"WorkingSetPrivateNum\":35069952,\"PoolNonpagedBytesNum\":77336,\"PoolPagedBytesNum\":891008,\"PrivateBytesNum\":88186880,\"MemoryInMBNum\":84.10156,\"WorkingSetInMBNum\":34.890625,\"WorkingSetPrivateInMBNum\":33.4453125,\"PoolNonpagedBytesInMBNum\":0.07375336,\"PoolPagedBytesInMBNum\":0.849731445,\"PrivateBytesInMBNum\":84.10156,\"NumProcesses\":1},\"services\":{ \"CPU\":\"0\",\"Memory\":\"8392704\",\"MemoryInMB\":\"8.0\",\"CPUNum\":0,\"WorkingSetNum\":8392704,\"WorkingSetPrivateNum\":6369280,\"PoolNonpagedBytesNum\":13040,\"PoolPagedBytesNum\":144408,\"PrivateBytesNum\":8130560,\"MemoryInMBNum\":8.003906,\"WorkingSetInMBNum\":8.003906,\"WorkingSetPrivateInMBNum\":6.07421875,\"PoolNonpagedBytesInMBNum\":0.0124359131,\"PoolPagedBytesInMBNum\":0.1377182,\"PrivateBytesInMBNum\":7.75390625,\"NumProcesses\":1},\"smss\":{ \"CPU\":\"0\",\"Memory\":\"360448\",\"MemoryInMB\":\"0.3\",\"CPUNum\":0,\"WorkingSetNum\":360448,\"WorkingSetPrivateNum\":245760,\"PoolNonpagedBytesNum\":2480,\"PoolPagedBytesNum\":12432,\"PrivateBytesNum\":294912,\"MemoryInMBNum\":0.34375,\"WorkingSetInMBNum\":0.34375,\"WorkingSetPrivateInMBNum\":0.234375,\"PoolNonpagedBytesInMBNum\":0.0023651123,\"PoolPagedBytesInMBNum\":0.0118560791,\"PrivateBytesInMBNum\":0.28125,\"NumProcesses\":1},\"splunkd\":{ \"CPU\":\"0\",\"Memory\":\"117956608\",\"MemoryInMB\":\"112.5\",\"CPUNum\":0,\"WorkingSetNum\":43106304,\"WorkingSetPrivateNum\":36515840,\"PoolNonpagedBytesNum\":23376,\"PoolPagedBytesNum\":169552,\"PrivateBytesNum\":117956608,\"MemoryInMBNum\":112.492188,\"WorkingSetInMBNum\":41.109375,\"WorkingSetPrivateInMBNum\":34.82422,\"PoolNonpagedBytesInMBNum\":0.02229309,\"PoolPagedBytesInMBNum\":0.161697388,\"PrivateBytesInMBNum\":112.492188,\"NumProcesses\":1},\"splunk-winevtlog\":{ \"CPU\":\"0\",\"Memory\":\"96608256\",\"MemoryInMB\":\"92.1\",\"CPUNum\":0,\"WorkingSetNum\":51441664,\"WorkingSetPrivateNum\":51314688,\"PoolNonpagedBytesNum\":86432,\"PoolPagedBytesNum\":133376,\"PrivateBytesNum\":96608256,\"MemoryInMBNum\":92.13281,\"WorkingSetInMBNum\":49.0585938,\"WorkingSetPrivateInMBNum\":48.9375,\"PoolNonpagedBytesInMBNum\":0.08242798,\"PoolPagedBytesInMBNum\":0.127197266,\"PrivateBytesInMBNum\":92.13281,\"NumProcesses\":1},\"spoolsv\":{ \"CPU\":\"0\",\"Memory\":\"7761920\",\"MemoryInMB\":\"7.4\",\"CPUNum\":0,\"WorkingSetNum\":7761920,\"WorkingSetPrivateNum\":5685248,\"PoolNonpagedBytesNum\":26784,\"PoolPagedBytesNum\":190360,\"PrivateBytesNum\":7725056,\"MemoryInMBNum\":7.40234375,\"WorkingSetInMBNum\":7.40234375,\"WorkingSetPrivateInMBNum\":5.421875,\"PoolNonpagedBytesInMBNum\":0.0255432129,\"PoolPagedBytesInMBNum\":0.181541443,\"PrivateBytesInMBNum\":7.3671875,\"NumProcesses\":1},\"sqlservr\":{ \"CPU\":\"0\",\"Memory\":\"392572928\",\"MemoryInMB\":\"374.4\",\"CPUNum\":0,\"WorkingSetNum\":51822592,\"WorkingSetPrivateNum\":45518848,\"PoolNonpagedBytesNum\":205264,\"PoolPagedBytesNum\":567968,\"PrivateBytesNum\":392572928,\"MemoryInMBNum\":374.386719,\"WorkingSetInMBNum\":49.421875,\"WorkingSetPrivateInMBNum\":43.4101563,\"PoolNonpagedBytesInMBNum\":0.195755,\"PoolPagedBytesInMBNum\":0.5416565,\"PrivateBytesInMBNum\":374.386719,\"NumProcesses\":1},\"sqlwriter\":{ \"CPU\":\"0\",\"Memory\":\"2404352\",\"MemoryInMB\":\"2.3\",\"CPUNum\":0,\"WorkingSetNum\":1744896,\"WorkingSetPrivateNum\":1339392,\"PoolNonpagedBytesNum\":10464,\"PoolPagedBytesNum\":82832,\"PrivateBytesNum\":2404352,\"MemoryInMBNum\":2.29296875,\"WorkingSetInMBNum\":1.6640625,\"WorkingSetPrivateInMBNum\":1.27734375,\"PoolNonpagedBytesInMBNum\":0.009979248,\"PoolPagedBytesInMBNum\":0.07899475,\"PrivateBytesInMBNum\":2.29296875,\"NumProcesses\":1},\"svchost\":{ \"CPU\":\"0\",\"Memory\":\"256892928\",\"MemoryInMB\":\"245.0\",\"CPUNum\":0,\"WorkingSetNum\":256892928,\"WorkingSetPrivateNum\":191074304,\"PoolNonpagedBytesNum\":387184,\"PoolPagedBytesNum\":2938792,\"PrivateBytesNum\":223281152,\"MemoryInMBNum\":244.992188,\"WorkingSetInMBNum\":244.992188,\"WorkingSetPrivateInMBNum\":182.222656,\"PoolNonpagedBytesInMBNum\":0.369247437,\"PoolPagedBytesInMBNum\":2.80265045,\"PrivateBytesInMBNum\":212.9375,\"NumProcesses\":14},\"Sysmon\":{ \"CPU\":\"0\",\"Memory\":\"71372800\",\"MemoryInMB\":\"68.1\",\"CPUNum\":0,\"WorkingSetNum\":71372800,\"WorkingSetPrivateNum\":67133440,\"PoolNonpagedBytesNum\":20352,\"PoolPagedBytesNum\":216768,\"PrivateBytesNum\":69169152,\"MemoryInMBNum\":68.06641,\"WorkingSetInMBNum\":68.06641,\"WorkingSetPrivateInMBNum\":64.02344,\"PoolNonpagedBytesInMBNum\":0.01940918,\"PoolPagedBytesInMBNum\":0.206726074,\"PrivateBytesInMBNum\":65.96484,\"NumProcesses\":1},\"System\":{ \"CPU\":\"0\",\"Memory\":\"3317760\",\"MemoryInMB\":\"3.2\",\"CPUNum\":0,\"WorkingSetNum\":3317760,\"WorkingSetPrivateNum\":53248,\"PoolNonpagedBytesNum\":0,\"PoolPagedBytesNum\":0,\"PrivateBytesNum\":126976,\"MemoryInMBNum\":3.1640625,\"WorkingSetInMBNum\":3.1640625,\"WorkingSetPrivateInMBNum\":0.05078125,\"PoolNonpagedBytesInMBNum\":0.0,\"PoolPagedBytesInMBNum\":0.0,\"PrivateBytesInMBNum\":0.12109375,\"NumProcesses\":1},\"TabTip\":{ \"CPU\":\"0\",\"Memory\":\"4648960\",\"MemoryInMB\":\"4.4\",\"CPUNum\":0,\"WorkingSetNum\":4648960,\"WorkingSetPrivateNum\":2146304,\"PoolNonpagedBytesNum\":16368,\"PoolPagedBytesNum\":222360,\"PrivateBytesNum\":3264512,\"MemoryInMBNum\":4.43359375,\"WorkingSetInMBNum\":4.43359375,\"WorkingSetPrivateInMBNum\":2.046875,\"PoolNonpagedBytesInMBNum\":0.0156097412,\"PoolPagedBytesInMBNum\":0.212059021,\"PrivateBytesInMBNum\":3.11328125,\"NumProcesses\":1},\"TabTip32\":{ \"CPU\":\"0\",\"Memory\":\"1282048\",\"MemoryInMB\":\"1.2\",\"CPUNum\":0,\"WorkingSetNum\":741376,\"WorkingSetPrivateNum\":729088,\"PoolNonpagedBytesNum\":7792,\"PoolPagedBytesNum\":93728,\"PrivateBytesNum\":1282048,\"MemoryInMBNum\":1.22265625,\"WorkingSetInMBNum\":0.70703125,\"WorkingSetPrivateInMBNum\":0.6953125,\"PoolNonpagedBytesInMBNum\":0.00743103027,\"PoolPagedBytesInMBNum\":0.08938599,\"PrivateBytesInMBNum\":1.22265625,\"NumProcesses\":1},\"taskeng\":{ \"CPU\":\"0\",\"Memory\":\"5500928\",\"MemoryInMB\":\"5.2\",\"CPUNum\":0,\"WorkingSetNum\":5500928,\"WorkingSetPrivateNum\":1056768,\"PoolNonpagedBytesNum\":8928,\"PoolPagedBytesNum\":57952,\"PrivateBytesNum\":1675264,\"MemoryInMBNum\":5.24609375,\"WorkingSetInMBNum\":5.24609375,\"WorkingSetPrivateInMBNum\":1.0078125,\"PoolNonpagedBytesInMBNum\":0.008514404,\"PoolPagedBytesInMBNum\":0.055267334,\"PrivateBytesInMBNum\":1.59765625,\"NumProcesses\":1},\"taskhost\":{ \"CPU\":\"0\",\"Memory\":\"23584768\",\"MemoryInMB\":\"22.5\",\"CPUNum\":0,\"WorkingSetNum\":23584768,\"WorkingSetPrivateNum\":17661952,\"PoolNonpagedBytesNum\":30864,\"PoolPagedBytesNum\":234696,\"PrivateBytesNum\":23248896,\"MemoryInMBNum\":22.4921875,\"WorkingSetInMBNum\":22.4921875,\"WorkingSetPrivateInMBNum\":16.84375,\"PoolNonpagedBytesInMBNum\":0.0294342041,\"PoolPagedBytesInMBNum\":0.223823547,\"PrivateBytesInMBNum\":22.171875,\"NumProcesses\":1},\"taskhostex\":{ \"CPU\":\"0\",\"Memory\":\"8101888\",\"MemoryInMB\":\"7.7\",\"CPUNum\":0,\"WorkingSetNum\":8101888,\"WorkingSetPrivateNum\":4419584,\"PoolNonpagedBytesNum\":29120,\"PoolPagedBytesNum\":210384,\"PrivateBytesNum\":6053888,\"MemoryInMBNum\":7.7265625,\"WorkingSetInMBNum\":7.7265625,\"WorkingSetPrivateInMBNum\":4.21484375,\"PoolNonpagedBytesInMBNum\":0.0277709961,\"PoolPagedBytesInMBNum\":0.200637817,\"PrivateBytesInMBNum\":5.7734375,\"NumProcesses\":1},\"Taskmgr\":{ \"CPU\":\"0\",\"Memory\":\"28823552\",\"MemoryInMB\":\"27.5\",\"CPUNum\":0,\"WorkingSetNum\":28823552,\"WorkingSetPrivateNum\":14643200,\"PoolNonpagedBytesNum\":27168,\"PoolPagedBytesNum\":513320,\"PrivateBytesNum\":18268160,\"MemoryInMBNum\":27.4882813,\"WorkingSetInMBNum\":27.4882813,\"WorkingSetPrivateInMBNum\":13.9648438,\"PoolNonpagedBytesInMBNum\":0.0259094238,\"PoolPagedBytesInMBNum\":0.4895401,\"PrivateBytesInMBNum\":17.421875,\"NumProcesses\":1},\"TNSLSNR\":{ \"CPU\":\"0\",\"Memory\":\"17866752\",\"MemoryInMB\":\"17.0\",\"CPUNum\":0,\"WorkingSetNum\":13037568,\"WorkingSetPrivateNum\":9396224,\"PoolNonpagedBytesNum\":24672,\"PoolPagedBytesNum\":245640,\"PrivateBytesNum\":17866752,\"MemoryInMBNum\":17.0390625,\"WorkingSetInMBNum\":12.4335938,\"WorkingSetPrivateInMBNum\":8.9609375,\"PoolNonpagedBytesInMBNum\":0.0235290527,\"PoolPagedBytesInMBNum\":0.234260559,\"PrivateBytesInMBNum\":17.0390625,\"NumProcesses\":1},\"unsecapp\":{ \"CPU\":\"0\",\"Memory\":\"1679360\",\"MemoryInMB\":\"1.6\",\"CPUNum\":0,\"WorkingSetNum\":1679360,\"WorkingSetPrivateNum\":958464,\"PoolNonpagedBytesNum\":6768,\"PoolPagedBytesNum\":58936,\"PrivateBytesNum\":1220608,\"MemoryInMBNum\":1.6015625,\"WorkingSetInMBNum\":1.6015625,\"WorkingSetPrivateInMBNum\":0.9140625,\"PoolNonpagedBytesInMBNum\":0.006454468,\"PoolPagedBytesInMBNum\":0.05620575,\"PrivateBytesInMBNum\":1.1640625,\"NumProcesses\":1},\"VBCSCompiler\":{ \"CPU\":\"0\",\"Memory\":\"220999680\",\"MemoryInMB\":\"210.8\",\"CPUNum\":0,\"WorkingSetNum\":208445440,\"WorkingSetPrivateNum\":166043648,\"PoolNonpagedBytesNum\":28528,\"PoolPagedBytesNum\":414736,\"PrivateBytesNum\":220999680,\"MemoryInMBNum\":210.761719,\"WorkingSetInMBNum\":198.789063,\"WorkingSetPrivateInMBNum\":158.351563,\"PoolNonpagedBytesInMBNum\":0.02720642,\"PoolPagedBytesInMBNum\":0.395523071,\"PrivateBytesInMBNum\":210.761719,\"NumProcesses\":1},\"VGAuthService\":{ \"CPU\":\"0\",\"Memory\":\"4947968\",\"MemoryInMB\":\"4.7\",\"CPUNum\":0,\"WorkingSetNum\":4341760,\"WorkingSetPrivateNum\":3461120,\"PoolNonpagedBytesNum\":12768,\"PoolPagedBytesNum\":134608,\"PrivateBytesNum\":4947968,\"MemoryInMBNum\":4.71875,\"WorkingSetInMBNum\":4.140625,\"WorkingSetPrivateInMBNum\":3.30078125,\"PoolNonpagedBytesInMBNum\":0.0121765137,\"PoolPagedBytesInMBNum\":0.128372192,\"PrivateBytesInMBNum\":4.71875,\"NumProcesses\":1},\"vmacthlp\":{ \"CPU\":\"0\",\"Memory\":\"1826816\",\"MemoryInMB\":\"1.7\",\"CPUNum\":0,\"WorkingSetNum\":1445888,\"WorkingSetPrivateNum\":1048576,\"PoolNonpagedBytesNum\":7136,\"PoolPagedBytesNum\":99728,\"PrivateBytesNum\":1826816,\"MemoryInMBNum\":1.7421875,\"WorkingSetInMBNum\":1.37890625,\"WorkingSetPrivateInMBNum\":1.0,\"PoolNonpagedBytesInMBNum\":0.00680542,\"PoolPagedBytesInMBNum\":0.09510803,\"PrivateBytesInMBNum\":1.7421875,\"NumProcesses\":1},\"vmms\":{ \"CPU\":\"0\",\"Memory\":\"40648704\",\"MemoryInMB\":\"38.8\",\"CPUNum\":0,\"WorkingSetNum\":9101312,\"WorkingSetPrivateNum\":7561216,\"PoolNonpagedBytesNum\":24128,\"PoolPagedBytesNum\":208808,\"PrivateBytesNum\":40648704,\"MemoryInMBNum\":38.765625,\"WorkingSetInMBNum\":8.6796875,\"WorkingSetPrivateInMBNum\":7.2109375,\"PoolNonpagedBytesInMBNum\":0.0230102539,\"PoolPagedBytesInMBNum\":0.199134827,\"PrivateBytesInMBNum\":38.765625,\"NumProcesses\":1},\"vmtoolsd\":{ \"CPU\":\"0\",\"Memory\":\"36392960\",\"MemoryInMB\":\"34.7\",\"CPUNum\":0,\"WorkingSetNum\":35336192,\"WorkingSetPrivateNum\":27238400,\"PoolNonpagedBytesNum\":60944,\"PoolPagedBytesNum\":529368,\"PrivateBytesNum\":36392960,\"MemoryInMBNum\":34.70703,\"WorkingSetInMBNum\":33.69922,\"WorkingSetPrivateInMBNum\":25.9765625,\"PoolNonpagedBytesInMBNum\":0.0581207275,\"PoolPagedBytesInMBNum\":0.504844666,\"PrivateBytesInMBNum\":34.70703,\"NumProcesses\":2},\"vstest.console\":{ \"CPU\":\"0\",\"Memory\":\"35504128\",\"MemoryInMB\":\"33.9\",\"CPUNum\":0,\"WorkingSetNum\":35504128,\"WorkingSetPrivateNum\":12476416,\"PoolNonpagedBytesNum\":30488,\"PoolPagedBytesNum\":399584,\"PrivateBytesNum\":23003136,\"MemoryInMBNum\":33.859375,\"WorkingSetInMBNum\":33.859375,\"WorkingSetPrivateInMBNum\":11.8984375,\"PoolNonpagedBytesInMBNum\":0.0290756226,\"PoolPagedBytesInMBNum\":0.381073,\"PrivateBytesInMBNum\":21.9375,\"NumProcesses\":1},\"WakeUpAgt\":{ \"CPU\":\"0\",\"Memory\":\"10178560\",\"MemoryInMB\":\"9.7\",\"CPUNum\":0,\"WorkingSetNum\":4079616,\"WorkingSetPrivateNum\":2547712,\"PoolNonpagedBytesNum\":22192,\"PoolPagedBytesNum\":199848,\"PrivateBytesNum\":10178560,\"MemoryInMBNum\":9.707031,\"WorkingSetInMBNum\":3.890625,\"WorkingSetPrivateInMBNum\":2.4296875,\"PoolNonpagedBytesInMBNum\":0.02116394,\"PoolPagedBytesInMBNum\":0.1905899,\"PrivateBytesInMBNum\":9.707031,\"NumProcesses\":1},\"wininit\":{ \"CPU\":\"0\",\"Memory\":\"897024\",\"MemoryInMB\":\"0.9\",\"CPUNum\":0,\"WorkingSetNum\":729088,\"WorkingSetPrivateNum\":630784,\"PoolNonpagedBytesNum\":8176,\"PoolPagedBytesNum\":109512,\"PrivateBytesNum\":897024,\"MemoryInMBNum\":0.85546875,\"WorkingSetInMBNum\":0.6953125,\"WorkingSetPrivateInMBNum\":0.6015625,\"PoolNonpagedBytesInMBNum\":0.007797241,\"PoolPagedBytesInMBNum\":0.104438782,\"PrivateBytesInMBNum\":0.85546875,\"NumProcesses\":1},\"winlogon\":{ \"CPU\":\"0\",\"Memory\":\"2207744\",\"MemoryInMB\":\"2.1\",\"CPUNum\":0,\"WorkingSetNum\":1437696,\"WorkingSetPrivateNum\":1318912,\"PoolNonpagedBytesNum\":10976,\"PoolPagedBytesNum\":142520,\"PrivateBytesNum\":2207744,\"MemoryInMBNum\":2.10546875,\"WorkingSetInMBNum\":1.37109375,\"WorkingSetPrivateInMBNum\":1.2578125,\"PoolNonpagedBytesInMBNum\":0.0104675293,\"PoolPagedBytesInMBNum\":0.135917664,\"PrivateBytesInMBNum\":2.10546875,\"NumProcesses\":1},\"WmiApSrv\":{ \"CPU\":\"0\",\"Memory\":\"5918720\",\"MemoryInMB\":\"5.6\",\"CPUNum\":0,\"WorkingSetNum\":5918720,\"WorkingSetPrivateNum\":1048576,\"PoolNonpagedBytesNum\":11232,\"PoolPagedBytesNum\":58728,\"PrivateBytesNum\":1335296,\"MemoryInMBNum\":5.64453125,\"WorkingSetInMBNum\":5.64453125,\"WorkingSetPrivateInMBNum\":1.0,\"PoolNonpagedBytesInMBNum\":0.01071167,\"PoolPagedBytesInMBNum\":0.0560073853,\"PrivateBytesInMBNum\":1.2734375,\"NumProcesses\":1},\"WmiPrvSE\":{ \"CPU\":\"2\",\"Memory\":\"170647552\",\"MemoryInMB\":\"162.7\",\"CPUNum\":2,\"WorkingSetNum\":170647552,\"WorkingSetPrivateNum\":122855424,\"PoolNonpagedBytesNum\":147720,\"PoolPagedBytesNum\":1113680,\"PrivateBytesNum\":154415104,\"MemoryInMBNum\":162.742188,\"WorkingSetInMBNum\":162.742188,\"WorkingSetPrivateInMBNum\":117.164063,\"PoolNonpagedBytesInMBNum\":0.14087677,\"PoolPagedBytesInMBNum\":1.062088,\"PrivateBytesInMBNum\":147.261719,\"NumProcesses\":7},\"WUDFHost\":{ \"CPU\":\"0\",\"Memory\":\"2273280\",\"MemoryInMB\":\"2.2\",\"CPUNum\":0,\"WorkingSetNum\":2052096,\"WorkingSetPrivateNum\":1511424,\"PoolNonpagedBytesNum\":11696,\"PoolPagedBytesNum\":101256,\"PrivateBytesNum\":2273280,\"MemoryInMBNum\":2.16796875,\"WorkingSetInMBNum\":1.95703125,\"WorkingSetPrivateInMBNum\":1.44140625,\"PoolNonpagedBytesInMBNum\":0.0111541748,\"PoolPagedBytesInMBNum\":0.09656525,\"PrivateBytesInMBNum\":2.16796875,\"NumProcesses\":1} } }";
            var definition = new { Value = new Dictionary<string, Process>() };
            var value = JsonConvert.DeserializeAnonymousType(json, definition);

            Assert.NotNull(value);
            Assert.NotNull(value.Value);
            Assert.NotEmpty(value.Value);
            //\"COMMONCLI\":{ \"CPU\":\"0\",\"Memory\":\"17719296\",\"MemoryInMB\":\"16.9\",\"CPUNum\":0,\"WorkingSetNum\":17719296,\"WorkingSetPrivateNum\":4505600,\"PoolNonpagedBytesNum\":15864,\"PoolPagedBytesNum\":251944,\"PrivateBytesNum\":14340096,\"MemoryInMBNum\":16.8984375,\"WorkingSetInMBNum\":16.8984375,\"WorkingSetPrivateInMBNum\":4.296875,\"PoolNonpagedBytesInMBNum\":0.0151290894,\"PoolPagedBytesInMBNum\":0.240272522,\"PrivateBytesInMBNum\":13.6757813,\"NumProcesses\":1}";
            bool exists = value.Value.TryGetValue("COMMONCLI", out Process commoncli);
            Assert.True(exists);

            // The name isn't part of the JSON data, it's just part of the map
            //Assert.Equal("COMMONCLI", common.Name);
            Assert.Equal((ulong)0, commoncli.CPUNum);
            Assert.Equal("0", commoncli.CPU);
            Assert.Equal((ulong)17719296, commoncli.WorkingSetNum);
            Assert.Equal((ulong)4505600, commoncli.WorkingSetPrivateNum);
            Assert.Equal((ulong)15864, commoncli.PoolNonpagedBytesNum);
            Assert.Equal((ulong)251944, commoncli.PoolPagedBytesNum);
            Assert.Equal((ulong)14340096, commoncli.PrivateBytesNum);
            Assert.Equal("17719296", commoncli.Memory);
            Assert.Equal((ulong)17719296, commoncli.MemoryNum);
            Assert.Equal(16.8984375, commoncli.MemoryInMBNum, 1);
        }

        [Fact]
        public void UsedForTesting1()
        {
            // Koper, Slovenia 2017/04/09
            string process_json =
"{\"Value\":{\"System\":{\"CPU\":\"0\",\"Memory\":\"331776\"},\"smss\":{\"CPU\":\"0\",\"Memory\":\"1863680\"},\"csrss\":{\"CPU\":\"0\",\"Memory\":\"17633280\"},\"wininit\":{\"CPU\":\"0\",\"Memory\":\"5865472\"},\"services\":{\"CPU\":\"0\",\"Memory\":\"12365824\"},\"lsass\":{\"CPU\":\"0\",\"Memory\":\"12025856\"},\"lsm\":{\"CPU\":\"0\",\"Memory\":\"7393280\"},\"winlogon\":{\"CPU\":\"0\",\"Memory\":\"10448896\"},\"svchost\":{\"CPU\":\"0\",\"Memory\":\"212434944\"},\"NVDisplay.Container\":{\"CPU\":\"0\",\"Memory\":\"10956800\"},\"nvwmi64\":{\"CPU\":\"0\",\"Memory\":\"20856832\"},\"nvxdsync\":{\"CPU\":\"0\",\"Memory\":\"31985664\"},\"RtkAudioService64\":{\"CPU\":\"0\",\"Memory\":\"7188480\"},\"RAVBg64\":{\"CPU\":\"0\",\"Memory\":\"14295040\"},\"AvastSvc\":{\"CPU\":\"9\",\"Memory\":\"176386048\"},\"spoolsv\":{\"CPU\":\"0\",\"Memory\":\"15777792\"},\"afwServ\":{\"CPU\":\"0\",\"Memory\":\"20742144\"},\"armsvc\":{\"CPU\":\"0\",\"Memory\":\"4235264\"},\"CASWatchDog\":{\"CPU\":\"0\",\"Memory\":\"86286336\"},\"COMMON\":{\"CPU\":\"0\",\"Memory\":\"52850688\"},\"IPROSetMonitor\":{\"CPU\":\"0\",\"Memory\":\"8097792\"},\"mqsvc\":{\"CPU\":\"0\",\"Memory\":\"11386880\"},\"TNSLSNR\":{\"CPU\":\"0\",\"Memory\":\"30158848\"},\"oracle\":{\"CPU\":\"0\",\"Memory\":\"990359552\"},\"SCC Camera Manager\":{\"CPU\":\"3\",\"Memory\":\"57344000\"},\"taskhost\":{\"CPU\":\"0\",\"Memory\":\"11603968\"},\"dwm\":{\"CPU\":\"0\",\"Memory\":\"41095168\"},\"taskeng\":{\"CPU\":\"0\",\"Memory\":\"7213056\"},\"explorer\":{\"CPU\":\"0\",\"Memory\":\"48537600\"},\"GoogleUpdate\":{\"CPU\":\"0\",\"Memory\":\"2678784\"},\"RAVCpl64\":{\"CPU\":\"0\",\"Memory\":\"13561856\"},\"AvastUI\":{\"CPU\":\"0\",\"Memory\":\"28057600\"},\"aswidsagenta\":{\"CPU\":\"0\",\"Memory\":\"35467264\"},\"iusb3mon\":{\"CPU\":\"0\",\"Memory\":\"6373376\"},\"IAStorIcon\":{\"CPU\":\"0\",\"Memory\":\"33624064\"},\"SearchIndexer\":{\"CPU\":\"0\",\"Memory\":\"14618624\"},\"wmpnetwk\":{\"CPU\":\"0\",\"Memory\":\"3850240\"},\"IAStorDataMgrSvc\":{\"CPU\":\"0\",\"Memory\":\"38125568\"},\"jhi_service\":{\"CPU\":\"0\",\"Memory\":\"5287936\"},\"LMS\":{\"CPU\":\"0\",\"Memory\":\"18665472\"},\"PrivacyIconClient\":{\"CPU\":\"0\",\"Memory\":\"19243008\"},\"CAS Archiver\":{\"CPU\":\"0\",\"Memory\":\"93532160\"},\"CAS Session Manager\":{\"CPU\":\"0\",\"Memory\":\"107634688\"},\"SLD CAS Server\":{\"CPU\":\"0\",\"Memory\":\"114176000\"},\"CAS Client\":{\"CPU\":\"0\",\"Memory\":\"144232448\"},\"scalc\":{\"CPU\":\"0\",\"Memory\":\"3915776\"},\"soffice\":{\"CPU\":\"0\",\"Memory\":\"4083712\"},\"soffice.bin\":{\"CPU\":\"0\",\"Memory\":\"175738880\"},\"WmiPrvSE\":{\"CPU\":\"0\",\"Memory\":\"60231680\"},\"WmiApSrv\":{\"CPU\":\"0\",\"Memory\":\"8323072\"}}}";
            var process_definition = new { Value = new Dictionary<string, Process>() };
            var process_value = JsonConvert.DeserializeAnonymousType(process_json, process_definition);

            Assert.NotNull(process_value);
            Assert.NotNull(process_value.Value);
            Assert.NotEmpty(process_value.Value);

            ulong process_memory = 0;
            foreach(Process p in process_value.Value.Values)
                process_memory += p.MemoryNum;

            Assert.Equal((ulong)2_859_143_168, process_memory);

            string memory_json =
                "{\"Value\":{\"Memory Capacity\":\"34271883264\",\"Free Memory\":\"28768792576\",\"Memory Used\":\"5503090688\"}}";
            var memory_definition = new { Value = new Dictionary<string, string>() };
            var memory_value = JsonConvert.DeserializeAnonymousType(memory_json, memory_definition);

            Assert.NotNull(memory_value);
            Assert.NotNull(memory_value.Value);
            Assert.NotEmpty(memory_value.Value);
            string used_str = string.Empty;
            memory_value.Value.TryGetValue("Memory Used", out used_str);

            Assert.NotEmpty(used_str);
            ulong used = 0;
            ulong.TryParse(used_str, out used);

            Assert.Equal((ulong)5_503_090_688, used);
        }

        [Fact]
        public void UsedForTesting2()
        {
            // Koper, Slovenia 2017/04/09
            string process_json =
"{\"Value\":{\"System\":{\"CPU\":\"25\",\"Memory\":\"77824\"},\"smss\":{\"CPU\":\"0\",\"Memory\":\"229376\"},\"csrss\":{\"CPU\":\"0\",\"Memory\":\"1806336\"},\"wininit\":{\"CPU\":\"0\",\"Memory\":\"393216\"},\"services\":{\"CPU\":\"0\",\"Memory\":\"3399680\"},\"lsass\":{\"CPU\":\"0\",\"Memory\":\"4583424\"},\"lsm\":{\"CPU\":\"0\",\"Memory\":\"2228224\"},\"winlogon\":{\"CPU\":\"0\",\"Memory\":\"475136\"},\"svchost\":{\"CPU\":\"0\",\"Memory\":\"79732736\"},\"NVDisplay.Container\":{\"CPU\":\"0\",\"Memory\":\"696320\"},\"nvwmi64\":{\"CPU\":\"0\",\"Memory\":\"2990080\"},\"nvxdsync\":{\"CPU\":\"0\",\"Memory\":\"2093056\"},\"RtkAudioService64\":{\"CPU\":\"0\",\"Memory\":\"368640\"},\"RAVBg64\":{\"CPU\":\"0\",\"Memory\":\"737280\"},\"AvastSvc\":{\"CPU\":\"7\",\"Memory\":\"57659392\"},\"spoolsv\":{\"CPU\":\"0\",\"Memory\":\"2260992\"},\"afwServ\":{\"CPU\":\"0\",\"Memory\":\"1777664\"},\"armsvc\":{\"CPU\":\"0\",\"Memory\":\"200704\"},\"CASWatchDog\":{\"CPU\":\"0\",\"Memory\":\"22044672\"},\"COMMON\":{\"CPU\":\"0\",\"Memory\":\"23445504\"},\"IPROSetMonitor\":{\"CPU\":\"0\",\"Memory\":\"401408\"},\"mqsvc\":{\"CPU\":\"0\",\"Memory\":\"1351680\"},\"TNSLSNR\":{\"CPU\":\"0\",\"Memory\":\"4628480\"},\"oracle\":{\"CPU\":\"0\",\"Memory\":\"671502336\"},\"SCC Camera Manager\":{\"CPU\":\"0\",\"Memory\":\"31064064\"},\"taskhost\":{\"CPU\":\"0\",\"Memory\":\"847872\"},\"dwm\":{\"CPU\":\"0\",\"Memory\":\"20525056\"},\"explorer\":{\"CPU\":\"0\",\"Memory\":\"8667136\"},\"RAVCpl64\":{\"CPU\":\"0\",\"Memory\":\"753664\"},\"AvastUI\":{\"CPU\":\"0\",\"Memory\":\"10248192\"},\"iusb3mon\":{\"CPU\":\"0\",\"Memory\":\"1019904\"},\"IAStorIcon\":{\"CPU\":\"0\",\"Memory\":\"6688768\"},\"aswidsagenta\":{\"CPU\":\"0\",\"Memory\":\"11886592\"},\"SearchIndexer\":{\"CPU\":\"0\",\"Memory\":\"9015296\"},\"wmpnetwk\":{\"CPU\":\"0\",\"Memory\":\"4124672\"},\"IAStorDataMgrSvc\":{\"CPU\":\"0\",\"Memory\":\"15953920\"},\"jhi_service\":{\"CPU\":\"0\",\"Memory\":\"245760\"},\"LMS\":{\"CPU\":\"0\",\"Memory\":\"421888\"},\"PrivacyIconClient\":{\"CPU\":\"0\",\"Memory\":\"14393344\"},\"scalc\":{\"CPU\":\"0\",\"Memory\":\"348160\"},\"soffice\":{\"CPU\":\"0\",\"Memory\":\"352256\"},\"soffice.bin\":{\"CPU\":\"0\",\"Memory\":\"37249024\"},\"GoogleUpdate\":{\"CPU\":\"0\",\"Memory\":\"348160\"},\"SLD CAS Server\":{\"CPU\":\"0\",\"Memory\":\"320483328\"},\"CAS Client\":{\"CPU\":\"0\",\"Memory\":\"21745664\"},\"CAS Archiver\":{\"CPU\":\"0\",\"Memory\":\"49381376\"},\"CAS Session Manager\":{\"CPU\":\"0\",\"Memory\":\"36622336\"},\"rundll32\":{\"CPU\":\"0\",\"Memory\":\"33980416\"},\"VSSVC\":{\"CPU\":\"0\",\"Memory\":\"14471168\"},\"WmiPrvSE\":{\"CPU\":\"0\",\"Memory\":\"59580416\"},\"WmiApSrv\":{\"CPU\":\"0\",\"Memory\":\"8122368\"}}}";
            var process_definition = new { Value = new Dictionary<string, Process>() };
            var process_value = JsonConvert.DeserializeAnonymousType(process_json, process_definition);

            Assert.NotNull(process_value);
            Assert.NotNull(process_value.Value);
            Assert.NotEmpty(process_value.Value);

            ulong process_memory = 0;
            foreach (Process p in process_value.Value.Values)
                process_memory += p.MemoryNum;

            Assert.Equal((ulong)1_603_624_960, process_memory);

            string memory_json =
                "{\"Value\":{\"Memory Capacity\":\"34271883264\",\"Free Memory\":\"309977088\",\"Memory Used\":\"33961906176\"}}";
            var memory_definition = new { Value = new Dictionary<string, string>() };
            var memory_value = JsonConvert.DeserializeAnonymousType(memory_json, memory_definition);

            Assert.NotNull(memory_value);
            Assert.NotNull(memory_value.Value);
            Assert.NotEmpty(memory_value.Value);
            string used_str = string.Empty;
            memory_value.Value.TryGetValue("Memory Used", out used_str);

            Assert.NotEmpty(used_str);
            ulong used = 0;
            ulong.TryParse(used_str, out used);

            Assert.Equal((ulong)33_961_906_176, used);
        }
    }
}
